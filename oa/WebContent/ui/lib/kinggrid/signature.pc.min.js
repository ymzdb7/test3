var $jscomp={scope:{},findInternal:function(c,h,b){c instanceof String&&(c=String(c));for(var f=c.length,k=0;k<f;k++){var l=c[k];if(h.call(b,l,k,c))return{i:k,v:l}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[h]=b.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,h,b,f){if(h){b=$jscomp.global;c=c.split(".");for(f=0;f<c.length-1;f++){var k=c[f];k in b||(b[k]={});b=b[k]}c=c[c.length-1];f=b[c];h=h(f);h!=f&&null!=h&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,b){return $jscomp.findInternal(this,c,b).v}},"es6-impl","es3");
(function(c,h,b,f){var k,l,u=!1;c.JSON&&(u='{"x":"\u4e2d"}'!==c.JSON.stringify({x:"\u4e2d"}));var m=h.Utils,n=b.options;m.extend(b.options.template,{signInfoBtl:'<div class="kg-dialog kg-dialog-info kg-dialog-signedinfo" id="kg-signedinfo"><%var modified = this.signModified;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u9a8c\u8bc1\u6b63\u5e38\uff01</span></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u7b7e\u540d\u6570\u636e\u88ab\u7be1\u6539\uff01</span></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class="active"><a href="#" kg-target="certinfo">\u8bc1\u4e66\u4fe1\u606f</a></li></ul><%var certinfo = this.signatureData.signMeta.certinfo; %><div class="kg-tab-content"><div class="kg-tab-pane active certinfo"><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u7248\u672c\uff1a</label><span class="kg-value">V<%certinfo.version%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5e8f\u53f7\uff1a</label><span class="kg-value"><%certinfo.serialNumber%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u540d\u7b97\u6cd5\uff1a</label><span class="kg-value"><%certinfo.algName%></span></div><div class="clearfix kg-item "><label class="kg-label">\u9881\u53d1\u8005\uff1a</label><span class="kg-value"><%certinfo.issuerDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u4f7f\u7528\u8005\uff1a</label><span class="kg-value"><%certinfo.subjectDN%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6709\u6548\u671f\u4ece\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notBefore) , "yyyy-MM-dd hh:mm:ss")%></span></div><div class="clearfix kg-item "><label class="kg-label">\u81f3\uff1a</label><span class="kg-value"><%kinggrid.Utils.formatDate(new Date(certinfo.notAfter) , "yyyy-MM-dd hh:mm:ss")%></span></div></div></div></div></div></div></div>',signatureInfoBtl:'<div class="kg-dialog kg-dialog-info" id="kg-sigantureinfo"><%var modified = this.modified;%><div class="kg-title success <%modified?"kg-hide":""%>"><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u6b63\u5e38\uff01</span></div><div class="kg-title danger  <%modified?"":"kg-hide"%> "><i class="kg-icon"></i><span>\u68c0\u6d4b\u7ed3\u679c\uff1a\u4fdd\u62a4\u6570\u636e\u88ab\u7be1\u6539\uff01</span></div><div class="kg-content"><div class="kg-tab"><ul class="kg-nav clearfix"><li class=" <% modified?"":"active"%> "><a href="#" kg-target="signatureinfo">\u7b7e\u7ae0\u4fe1\u606f</a></li><%if(modified){%><li class=" <% modified?"active":""%> " ><a href="#" kg-target="modifieditems">\u7be1\u6539\u4fe1\u606f</a></li><%}%></ul><div class="kg-tab-content"><div class="kg-tab-pane <% modified?"":"active"%> signatureinfo"><% var SDATA = this.signatureData; %><% var modifiedItems = this.modifiedItems; %><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label">\u5e94\u7528\u7a0b\u5e8f\uff1a</label><span class="kg-value"><%SDATA.appname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u6388\u6743\u5355\u4f4d\uff1a</label><span class="kg-value"><%SDATA.orgname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7528\u6237\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.username%></span></div><div class="clearfix kg-item "><label class="kg-label">\u5bc6\u94a5\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.keysn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u540d\u79f0\uff1a</label><span class="kg-value"><%SDATA.seal.signname%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u5e8f\u5217\uff1a</label><span class="kg-value"><%SDATA.seal.signsn%></span></div><div class="clearfix kg-item "><label class="kg-label">\u7b7e\u7ae0\u65e5\u671f\uff1a</label><span class="kg-value"><%SDATA.timestamp.signtime%></span></div></div></div><%if(modified){%><%var modifiedItems = this.modifiedItems;%><% for(var i=0;i<modifiedItems.length;i++) {%><% var item = modifiedItems[i]; %><div class="kg-tab-pane modifieditems <% modified?"active":""%> "><div class="kg-meta"><div class="clearfix kg-item "><label class="kg-label" kg-field="<%item.field%>"><%item.desc%>\u7531\uff1a</label><span class="kg-value"><%this["_renderValue"](item.orivalue) %></span></div><div class="clearfix kg-item "><label class="kg-label">\u66f4\u6539\u4e3a\uff1a</label><span class="kg-value"><%this["_renderValue"](item.newvalue)%></span></div></div></div><%}%><%}%></div></div></div></div>',
handwritedlg:'<div class="kg-dialog kg-dialog-info" id="kg-handwrite" unselectable="on" onselectstart="return false;" style="-moz-user-select:none;">\u540d\u79f0:<input type="text" value="\u624b\u5199\u7b7e\u540d" id="nameid" />&nbsp;&nbsp;&nbsp;\u989c\u8272:<select id="hw_color"><option value="black">\u9ed1</option><option value="red">\u7ea2</option><option value="blue">\u84dd</option><option value="green">\u7eff</option></select>&nbsp;&nbsp;&nbsp;\u7b14\u5bbd:<select id="hw_width"><option value="1">1</option><option value="2" selected>2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option></select><canvas id="canvasId" width=670px height=500px></canvas><br /><div id="div-judge" style="display: block" align="center"><button type="button" id="clearid" class="kg-button">\u6e05\u9664</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" id="okid" class="kg-button">\u7b7e\u540d</button></div></div>',
barcodedlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><label class="kg-label">\u4e8c\u7ef4\u7801\u5185\u5bb9\uff1a</label><textarea id="bcId"></textarea><br /><div id="output"><br /></div><div id="div-judge" style="display: block"><button type="button" id="bc_clearid" class="kg-button">\u6e05\u9664</button><button type="button" id="bc_okid" class="kg-button">\u786e\u5b9a</button></div></div>',scanBCdlg:'<div class="kg-dialog kg-dialog-info" id="kg-barcode"><div id="support"></div> <div id="contentHolder"><video id="video" width="320" height="320" autoplay></video><canvas style="display:none; background-color:#F00;" id="canvas_scanBC" width="320" height="320"></canvas> <br/> </div></div>'});
kingPlus();var q,p;b.addLiseter("init",function(){q=b.aisleKing;for(var a=b.options.icons,e=0;e<a.length;++e){var g=a[e];switch(g.iconClass){case "kg-icon-move":null!=b.options.icon_move&&0==b.options.icon_move&&(g.enable=!1);break;case "kg-icon-remove":null!=b.options.icon_remove&&0==b.options.icon_remove&&(g.enable=!1);break;case "kg-icon-sign":null!=b.options.icon_sign&&0==b.options.icon_sign&&(g.enable=!1);break;case "kg-icon-signverify":null!=b.options.icon_signverify&&0==b.options.icon_signverify&&
(g.enable=!1);break;case "kg-icon-sealinfo":null!=b.options.icon_sealinfo&&0==b.options.icon_sealinfo&&(g.enable=!1)}}});b.addLiseter("beforeVerify",function(){p=[];k=[];l=[]});b.addLiseter("eachVerify",function(a){a.broken&&(p.push(a),k.push(a.signatureData.seal.signsn),l.push(a.signatureData.seal.imgdata))});b.addLiseter("verify",function(){0<p.length&&q.request(n.imageUrl,{signsn:k,sealImg:l}).ret(function(a){if(a.result){a=a.imageUrl||n.imageUrl+"_";for(var e=0;e<p.length;e++){var g=p[e],c=g.imgEles,
d;for(d in c)c[d].find(".kg-img").attr({src:b.aisleKing.serverUrl+a+"?a0=0&signsn="+g.signatureData.seal.signsn});delete g.broken}}else b.alert(h.msg(a.errcode,"then"))}).fail(function(a,e){b.alert(h.msg(e.errcode,"then"));a(null)})});var r={},t;f(window).resize(function(){t&&clearTimeout(t);t=setTimeout(function(){for(var a in r){var e=f(r[a]),g=f(m.$(e.attr("elemid")));b.prototype.calSealPos.call(null,g,e)}},200)});m.extend(b.prototype,{_init:function(){var a=this;a.on("showAt",function(a){m.$(a.getAttribute("elemid")).getAttribute("display")||
(r[a.id]=a)});a.on("removeAt",function(a){delete r[a.id]});a.on("beforeShowAt",function(a){3960<this.signatureData.seal.imgdata.length&&u&&(this.brokenImgDiv=a)});a.on("showAt",function(){if(a.brokenImgDiv){var e=a.signatureData.seal;q&&q.request(a.imageUrl,{signsn:e.signsn,sealImg:e.imgdata}).ret(function(g){g.result&&(g=g.imageUrl||a.imageUrl+"_",f(a.brokenImgDiv).find(".kg-img").attr({src:b.aisleKing.serverUrl+g+"?a0=0&signsn="+e.signsn}),delete a.brokenImgDiv)})}});a.on("showAt",function(b){b=
f(b);b.on("click",function(){a._verify();a.signatureInfo()});b.append('<div class="kgImgIcons kg-img-icons" ></div>')});a.on("handleImg",function(b){var g=f(b);g.find(".kg-img-icon").remove();if(n.icons)for(var g=g.children(".kg-img-icons"),c=n.icons.length-1;0<=c;c--){var d=n.icons[c];if(m.val(d.enable,a,b)){var e=f('<a href="#" title="'+d.title+'" class="kg-img-icon" id="kg-img-icon-'+d.id+"-"+this.signatureid+'"><i class="'+d.iconClass+'"></i></a>');g.append(e);d.exec&&d.exec.call(a,b);(function(b,
d,c){e.click(function(d){d.imgDiv=b;c.call(a,d,b)})})(b,e,d.click||function(a){a.preventDefault();a.stopPropagation()})}}})},signatureInfo:function(){return this.showDialog("signatureInfoBtl",{target:this,onCancel:!1,onShow:function(){var a=this.find(".kg-tab");this.tab=m.tab(a)}})},signInfo:function(){return this.showDialog("signInfoBtl",{title:"\u7b7e\u540d\u9a8c\u8bc1",target:this,onCancel:!1})},handWriteDlg:function(a,b){var c=this.showDialog("handwritedlg",{title:"\u624b\u5199\u7b7e\u540d",target:this,
onCancel:!1}),e=document.getElementById("canvasId");a.penColor=document.getElementById("hw_color").value;a.minWidth=.5;a.maxWidth=4.5;var d=new SignaturePad(e,a);e.onmouseleave=function(a){d.simulate_mouseevent(e,"mouseup");d.simulate_mouseevent(document.getElementById("kg-handwrite"),"mouseup")};f("#hw_color").click(function(){var a=document.getElementById("hw_color").value;d.penColor=a});f("#hw_width").click(function(){switch(document.getElementById("hw_width").value){case "1":d.minWidth=.5;d.maxWidth=
2.5;break;case "2":d.minWidth=.5;d.maxWidth=4.5;break;case "3":d.minWidth=1;d.maxWidth=6;break;case "4":d.minWidth=1;d.maxWidth=8;break;case "5":d.minWidth=2.5;d.maxWidth=10;break;case "6":d.minWidth=3;d.maxWidth=12;break;default:d.minWidth=.5,d.maxWidth=2.5}});var h=document.getElementById("clearid"),k=document.getElementById("okid");h&&(h.onclick=function(){d.clear()});k&&(k.onclick=function(){c.close();var e=d.toDataURL().replace(/^data:image\/\w+;base64,/,"");e&&(e={height:a.image_height||"5.00",
width:a.image_width||"6.70",imageData:e,name:document.getElementById("nameid").value},b(e))})},barCodeDlg:function(a,b){if(void 0!=a.content&&null!=a.content){var c=f("#output").qrcode(a.content);b({height:a.image_height||"5",width:a.image_width||"5",imageData:c,name:"\u4e8c\u7ef4\u7801"})}},scanBCDlg:function(a,b){var c=this.showDialog("scanBCdlg",{title:"\u626b\u7801\u7b7e\u7ae0",target:this,onCancel:!1});try{var e=document.getElementById("canvas_scanBC").getContext("2d"),d=document.getElementById("video"),
h={video:!0,audio:!1},k=!0,l=function(a){k=!1;a.PERMISSION_DENIED?alert("\u7528\u6237\u62d2\u7edd\u4e86\u6d4f\u89c8\u5668\u8bf7\u6c42\u5a92\u4f53\u7684\u6743\u9650","\u63d0\u793a"):a.NOT_SUPPORTED_ERROR?alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668","\u63d0\u793a"):a.MANDATORY_UNSATISFIED_ERROR?alert("\u6307\u5b9a\u7684\u5a92\u4f53\u7c7b\u578b\u672a\u63a5\u6536\u5230\u5a92\u4f53\u6d41",
"\u63d0\u793a"):alert("\u7cfb\u7edf\u672a\u80fd\u83b7\u53d6\u5230\u6444\u50cf\u5934\uff0c\u8bf7\u786e\u4fdd\u6444\u50cf\u5934\u5df2\u6b63\u786e\u5b89\u88c5\u3002\u6216\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\uff0c\u91cd\u8bd5","\u63d0\u793a")};if(navigator.getUserMedia){if(-1<navigator.userAgent.indexOf("MQQBrowser"))return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668","\u63d0\u793a"),!1;navigator.getUserMedia(h,
function(a){d.src=a;d.play()},l)}else if(navigator.webkitGetUserMedia)navigator.webkitGetUserMedia(h,function(a){d.src=window.webkitURL.createObjectURL(a);d.play()},l);else if(navigator.mozGetUserMedia)navigator.mozGetUserMedia(h,function(a){d.src=window.URL.createObjectURL(a);d.play()},l);else if(navigator.msGetUserMedia)navigator.msGetUserMedia(h,function(a){f(document).scrollTop(f(window).height());d.src=window.URL.createObjectURL(a);d.play()},l);else return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u62cd\u7167\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u6d4f\u89c8\u5668"),
!1;k&&alert("\u4e3a\u4e86\u83b7\u5f97\u66f4\u51c6\u786e\u7684\u6d4b\u8bd5\u7ed3\u679c\uff0c\u8bf7\u5c3d\u91cf\u5c06\u4e8c\u7ef4\u7801\u7f6e\u4e8e\u6846\u4e2d\uff0c\u7136\u540e\u8fdb\u884c\u62cd\u6444\u3001\u626b\u63cf\u3002 \u8bf7\u786e\u4fdd\u6d4f\u89c8\u5668\u6709\u6743\u9650\u4f7f\u7528\u6444\u50cf\u529f\u80fd");var m=setTimeout(function(){e&&(e.drawImage(d,0,0,320,320),f("#contentHolder").html5_qrcode(function(d){f("#read").html(d);c.close();alert(d);a.content=d;barCodeDlg(a,b);window.clearInterval(m)},
function(a){f("#read_error").html(a);c.close();window.clearInterval(m)},function(a){f("#vid_error").html(a);c.close();window.clearInterval(m)}))},200)}catch(v){printHtml("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301HTML5 CANVAS")}}});b.addIcon({iconClass:"kg-icon-move",title:"\u79fb\u52a8\u7b7e\u7ae0",id:"moveSignature",enable:function(a){return this.canMove(a)},exec:function(a){var c=this,g=!0;f(a).on("touchstart mousedown",".kg-icon-move",function(b){g&&c.runMove(b,a)});f(a).on("touchstart mouseover",".kg-icon-move",
function(c){void 0!==b.options.extra&&(c=a.attributes.signatureid.nodeValue)&&void 0!==b.options.extra[c]&&(g=b.options.extra[c].icon_move())})}});b.addIcon({iconClass:"kg-icon-remove",title:"\u64a4\u9500\u7b7e\u7ae0",id:"revokeSignature",enable:function(){return this.canDelete()},click:function(a){a.preventDefault();a.stopPropagation();this.revokeSignature()}});b.addIcon({iconClass:"kg-icon-sign",title:"\u6570\u5b57\u7b7e\u540d",id:"sign",enable:function(){return this.canSign()},click:function(a){a.preventDefault();
a.stopPropagation();this._verify()?this.signSignature():b.alert("\u7b7e\u7ae0\u65e0\u6548\uff0c\u4e0d\u80fd\u6267\u884c\u6570\u5b57\u7b7e\u540d\uff01")}});b.addIcon({iconClass:"kg-icon-signverify",title:"\u7b7e\u540d\u9a8c\u8bc1",id:"verifysign",enable:function(){return this.signatureData.signMeta},click:function(a){a.preventDefault();a.stopPropagation();var b=this;b.verifySignData(function(a){a.errcode?b.warning(a):b.signInfo()})}});b.addIcon({iconClass:"kg-icon-sealinfo",title:"\u7b7e\u7ae0\u9a8c\u8bc1",
id:"signatureInfo",enable:!0,click:function(a){a.preventDefault();a.stopPropagation();this._verify();this.signatureInfo()}})})(this,kinggrid,Signature,jQuery);
// V1.0.0.280A    
//# sourceMappingURL=c:/signature.pc.min.map
